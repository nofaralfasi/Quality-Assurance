#!/usr/bin/perl
## Initially generated by Win32-GuiTest Recorder (v1.03)

## Pragmas/Directives
use strict;
use warnings;

## Imports
use Win32::GuiTest qw/:ALL/;
use Win32::GuiTest qw(FindWindowLike WMGetText);

$Win32::GuiTest::debug = 0; # Set to "1" to enable debug output.

sub setFocus{
	my ($str) = @_;
	my $win = WaitWindowLike(undef, $str);
	SetForegroundWindow($win);
	SetFocus($win);
	sleep(2);	
}

sub ctrlKey{
	my ($key) = @_;
	SendRawKey(VK_LCONTROL, KEYEVENTF_EXTENDEDKEY);
	SendKeys($key);
	SendRawKey(VK_LCONTROL, KEYEVENTF_EXTENDEDKEY | KEYEVENTF_KEYUP);
	sleep(2);	
}

sub shiftKey{
	my ($key) = @_;
	SendRawKey(VK_LSHIFT, KEYEVENTF_EXTENDEDKEY);
	SendKeys($key);
	SendRawKey(VK_LSHIFT, KEYEVENTF_EXTENDEDKEY | KEYEVENTF_KEYUP);
	sleep(2);	
}

sub altKey{
	my ($key) = @_;
	SendRawKey(VK_LMENU, KEYEVENTF_EXTENDEDKEY);
	SendKeys($key);
	SendRawKey(VK_LMENU, KEYEVENTF_EXTENDEDKEY | KEYEVENTF_KEYUP);
	sleep(2);	
}

## Main/Core
my %h;
my $i;

setFocus("Paint");

my @windows = FindWindowLike(0, "", "Paint");
die "No notepad is running, please open one with some text in it.\n" if not @windows;
sleep(2);
	
my $notepad = $windows[0];

#Set focus to the unsaved notepad file
setFocus("Paint");

#Resize window
ctrlKey("w");
sleep(2);
SendKeys('{SPACE}{RIGHT}{TAB}600{TAB}{TAB}{TAB}{TAB}{TAB}{ENT}');
sleep(2);

#Save file
ctrlKey("s");
sleep(2);
#Exit
SendKeys("%{F4}");
 
 

